(window.webpackJsonp=window.webpackJsonp||[]).push([[25],{410:function(n,t,e){"use strict";e.r(t);var o=e(45),s=Object(o.a)({},(function(){var n=this,t=n.$createElement,e=n._self._c||t;return e("ContentSlotsDistributor",{attrs:{"slot-key":n.$parent.slotKey}},[e("h3",{attrs:{id:"vue-typescript踩坑-初始化项目"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#vue-typescript踩坑-初始化项目"}},[n._v("#")]),n._v(" Vue + TypeScript踩坑(初始化项目)")]),n._v(" "),e("hr"),n._v(" "),e("ul",[e("li",[n._v("前言，最近公司新项目需要进行重构，框架选择为Vue+TypeScript，记录初始化中不完全踩坑指南\n"),e("br")])]),n._v(" "),e("h5",{attrs:{id:"_1-项目改造"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1-项目改造"}},[n._v("#")]),n._v(" 1.项目改造")]),n._v(" "),e("p",[n._v("安装所需的插件\n"),e("code",[n._v("npm install vue-property-decorator vuex-class --save")]),n._v(" "),e("code",[n._v("npm install ts-loader typescript typescript-eslint-parser --save-dev")]),n._v(" "),e("br"),n._v("\n这些库的作用，可以按需引入")]),n._v(" "),e("ul",[e("li",[e("a",{attrs:{href:"https://github.com/kaorun343/vue-property-decorator",title:"vue-property-decorator",target:"_blank",rel:"noopener noreferrer"}},[n._v("vue-property-decorator"),e("OutboundLink")],1),n._v("：在vue-class-component的基础上优化{Emit, Inject, Model, Prop, Provide, Watch, Component}")]),n._v(" "),e("li",[e("a",{attrs:{href:"https://github.com/ktsn/vuex-class",title:"vuex-class",target:"_blank",rel:"noopener noreferrer"}},[n._v("vuex-class"),e("OutboundLink")],1),n._v("：ts版的vuex插件")]),n._v(" "),e("li",[n._v("ts-loader: webpack插件")]),n._v(" "),e("li",[n._v("typescript： 必备插件")]),n._v(" "),e("li",[n._v("typescript-eslint-parser： eslint解析ts插件")])]),n._v(" "),e("br"),n._v("\n##### 2.WebPack配置修改\nwebpac.conf中添加ts的解析module\nextensions中添加ts结尾的文件\n"),e("div",{staticClass:"language- extra-class"},[e("pre",[e("code",[n._v("entry: {\n\tapp: './src/main.ts'\n},\n// ....\nextensions: ['.js', '.vue', '.json', '.ts'],\n// ....\n{\n    test: /\\.ts$/,\n    loader: 'ts-loader',\n    exclude: /node_modules/,\n    options: {\n      appendTsSuffixTo: [/\\.vue$/],\n    }\n}\n")])])]),e("h5",{attrs:{id:"_3-添加tsconfig-json、d-ts文件-修改eslint"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3-添加tsconfig-json、d-ts文件-修改eslint"}},[n._v("#")]),n._v(" 3.添加tsconfig.json、d.ts文件，修改eslint")]),n._v(" "),e("p",[n._v("修改eslint解析规则为ts")]),n._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",[e("code",[n._v("// ...\nparserOptions: {\n\tparser: 'typescript-eslint-parser'\n},\n// ...\n plugins: [\n    'vue',\n    'typescript'\n],\n")])])]),e("p",[n._v("在.eslintrc.js同级目录创建tsconfig.json文件")]),n._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",[e("code",[n._v('{\n  "include": [\n    "src/*",\n    "src/**/*"\n  ],\n  "exclude": [\n    "node_modules"\n  ],\n  "compilerOptions": {\n    // types option has been previously configured\n    "types": [\n      // add node as an option\n      "node"\n    ],\n    // typeRoots option has been previously configured\n    "typeRoots": [\n      // add path to @types\n      "node_modules/@types"\n    ],\n    // 以严格模式解析\n    "strict": true,\n    "strictPropertyInitialization": false,\n    // 在.tsx文件里支持JSX\n    "jsx": "preserve",\n    // 使用的JSX工厂函数\n    "jsxFactory": "h",\n    // 允许从没有设置默认导出的模块中默认导入\n    "allowSyntheticDefaultImports": true,\n    // 启用装饰器\n    "experimentalDecorators": true,\n    "strictFunctionTypes": false,\n    // 允许编译javascript文件\n    "allowJs": true,\n    // 采用的模块系统\n    "module": "esnext",\n    // 编译输出目标 ES 版本\n    "target": "es5",\n    // 如何处理模块\n    "moduleResolution": "node",\n    // 在表达式和声明上有隐含的any类型时报错\n    "noImplicitAny": true,\n    "lib": [\n      "dom",\n      "es5",\n      "es6",\n      "es7",\n      "es2015.promise"\n    ],\n    "sourceMap": true,\n    "pretty": true\n  }\n}\n')])])]),e("p",[n._v("在src目录下添加/typings/vue-shims.d.ts，声明所有的.vue文件")]),n._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",[e("code",[n._v('declare module "*.vue" {\n  import Vue from "vue";\n  export default Vue;\n}\n')])])]),e("br"),n._v(" "),e("h5",{attrs:{id:"_4-对原有文件进行改造"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_4-对原有文件进行改造"}},[n._v("#")]),n._v(" 4.对原有文件进行改造")]),n._v(" "),e("p",[n._v("/src/router/index.ts")]),n._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",[e("code",[n._v("import Vue, { AsyncComponent } from 'vue'\nimport Router, { RouteConfig, Route, NavigationGuard } from 'vue-router'\nconst Home: AsyncComponent = (): any => import('@/views/Home/index.vue')\n\nVue.use(Router)\n\nconst routes: RouteConfig[] = [\n  {\n    path: '/',\n    name: 'Home',\n    component: Home\n  }\n]\n\nconst router: Router = new Router({\n  mode: 'history',\n  base: '/',\n  routes\n})\n\nexport default router\n")])])]),e("p",[n._v("/src/store\nindex.ts")]),n._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",[e("code",[n._v("import Vue from 'vue'\nimport Vuex, {ActionTree, MutationTree} from 'vuex'\nimport actions from './actions'\nimport mutations from './mutations';\nimport getters from './getters'\n\nVue.use(Vuex)\n\ninterface State {\n  token: string,\n  login: Boolean,\n}\n\nlet state: State = {\n  token: 'token',\n  login: false\n}\n\nexport default new Vuex.Store({\n  state,\n  getters,\n  mutations,\n  actions\n})\n")])])]),e("p",[n._v("mutations.ts")]),n._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",[e("code",[n._v("import TYPES from './types'\nimport { MutationTree } from 'vuex'\n\nconst mutations: MutationTree<any> = {\n  [TYPES.SET_TOKEN](state, token): void{\n    state.token = token\n  }\n}\n\nexport default mutations\n")])])]),e("p",[n._v("actions.ts")]),n._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",[e("code",[n._v("import { ActionTree } from 'vuex'\nimport TYPES from './types'\n\nconst actions: ActionTree<any, any> = {\n  \n  initToken({commit}, token: string) {\n    commit(TYPES.SET_TOKEN, token)\n  }\n}\n")])])]),e("p",[n._v("export default actions")]),n._v(" "),e("p",[n._v("/src/main.ts")]),n._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",[e("code",[n._v("import Vue from 'vue';\nimport App from './App.vue';\nimport store from './store'\nimport router from './router';\n\nVue.config.productionTip = false\n\nnew Vue({\n  el: '#app',\n  router,\n  store,\n  components: { App },\n  template: '<App/>'\n})\n")])])]),e("br"),n._v("\n##### 5.vue-property-decorator使用\n"),e("p",[n._v("vue-property-decorator基于vue-class-component封装\n提供了7种方法\n"),e("code",[n._v("import {Emit, Inject, Model, Prop, Provide, Watch, Componet}")])]),n._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",[e("code",[n._v("<script lang=\"ts\">\nimport Vue from 'vue'\nimport {Component, Prop, Emit} from 'vue-property-decorator'\n\ninterface List {\n  title: string,\n  imgSrc: string,\n  url?: string\n}\n\n@Component({\n\tname: 'HomeBlock',\n\tcomponent: {\n\t\t// 这里注册组件\n\t}\n})\nexport default class HomeBlock extends Vue  {\n  @Prop({default: []})\n  dataList: List[]\n  // 等同于\n  // props: {\n  //  dataList: {\n  // \tdefault: [],\n  //\ttype: Array\n  //   }\n  //}\n\n  @Emit('jump')\n  jumpRoute(url: string){\n\t// ...\n  }\n  // 等同于\n  // jumpRoute(url) {\n  // \tthis.$emit('jump', url)\n  // }\n  \n  @Watch('child')\n  onChildChanged(val: string, oldVal: string) { }\n  // 等同于\n  // watch: {\n  //   'child': {\n  //     handler: 'onChildChanged',\n  //     immediate: false,\n  //     deep: false\n  //   },\n  // }\n  mounted() {\n    console.log(this.dataList)\n  }\n}\n<\/script>\n")])])]),e("p",[n._v("<br / >")]),n._v(" "),e("h5",{attrs:{id:"错误汇总"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#错误汇总"}},[n._v("#")]),n._v(" 错误汇总")]),n._v(" "),e("ol",[e("li",[n._v("typescript版本过新为3.1.x的情况会提示无法找到vue-loader，需要降级到2.8.x")]),n._v(" "),e("li",[n._v("TS2564:Property 'xx' has no initializer and in not definitely assigned in constructor\n在ts新版本中加入的，属性初始化可能为undefined的情况需要考虑进去\n解决方案1，在定义的时候例如 url: string | undefined （不太清楚方法要怎么定义，ts不太熟）\n解决方案2，在tsconfig的compilerOptions中 添加"),e("code",[n._v('"strictPropertyInitialization": false,')])])])])}),[],!1,null,null,null);t.default=s.exports}}]);